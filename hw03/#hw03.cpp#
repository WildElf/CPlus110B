// Assignment 3 - Eric Zimmerman
// guesses the number user is thinking of

#include <iostream>
#include <ctime>
#include <cstdlib>
using namespace std;

// Prototyped functions
void playOneGame ();
bool shouldPlayAgain ();
char getUserResponseToGuess(int);
int getMidpoint(int, int);
int getRandomMidpoint (int, int);


/// Program start and loop based on user choice

int main ()
{
	do
	{
		playOneGame();
	} while (shouldPlayAgain());

	return 0;
}

/// *********************************
/// The number guessing game function
/// *********************************
void playOneGame ()
{
	// variables for number guessing
	int midpoint, lowpoint, highpoint;
	char choice;

	// Establish starting number range
	const int LOW_RANGE = 1;
	const int HIGH_RANGE = 100;
	lowpoint = LOW_RANGE;
	highpoint = HIGH_RANGE;
	
	cout << "Think of a number between " << lowpoint 
		<< " and " << highpoint << ".\n";

	// number guessing loop, runs at least once
	do
	  {	
	    // get a number to guess
		midpoint = getMidpoint(lowpoint, highpoint);
/* Disabled
		// guess a random number
		midpoint = getRandomMidpoint(lowpoint, highpoint);
*/		

		// get user response to guess
		choice = getUserResponseToGuess(midpoint);

		// adjust guessing range based on user response
		if (choice == 'h')
			lowpoint = midpoint + 1;
		else if (choice == 'l')
			highpoint = midpoint - 1;
		else if (choice == 'c')
			cout << "Witness my psychic powers!\n";
} while (choice != 'c'); // continue until 'c' for correct


/// Use known highest and lowest numbers
/// to get the midpoint for next guess
/// **********
int getMidpoint(int low, int high)
{
	int mid = (low + high) / 2;

	return mid;
}

/// Similar yo getMidpoint, except
/// get a random midpoint for next guess
/// ***********
int getRandomMidpoint (int low, int high)
{
	// random number setup
	unsigned long seed = time(0);
	srand(seed);

	int mid = (rand() % (high - low + 1)) + low;

	return mid;
}

/// Show user the guess and get input
/// ***********
char getUserResponseToGuess(int guess)
{
	char choice = 0;

	// ensure user enters appropriate response
	while (choice != 'h' && choice !='l' && choice !='c')
	{
		cout << "Is it " << guess << "? (h/l/c): ";
		cin >> choice;
	
		// normalize user input
		if (choice == 'h' || choice == 'H')
			choice = 'h';
		else if (choice == 'l' || choice == 'L')
			choice = 'l';
		else if (choice == 'c' || choice == 'C')
			choice = 'c';
		else
			cout << "I don't understand what you want from me.\n"
			<< "Enter H if your number is higher than my guess,\n"
			<< "input L if your number is lower, and\n"
			<< "C if I got your number.\n";
	}

	return choice;
}

/// Checks to see if the user wants to repeat the game
/// ************
bool shouldPlayAgain ()
{
	char playAgain;	

	cout << "Do you want to play again? (y/n): ";
	cin >> playAgain;

	if (playAgain == 'y' || playAgain == 'Y')
		return true;
	else
		return false;
}

/*

** Non-random function **
Silica:desktop ez$ ./a.out
Think of a number between 1 and 100.
Is it 50? (h/l/c): h
Is it 75? (h/l/c): h
Is it 88? (h/l/c): h
Is it 94? (h/l/c): h
Is it 97? (h/l/c): h
Is it 99? (h/l/c): c
Witness my psychic powers!
Do you want to play again? (y/n): y
Think of a number between 1 and 100.
Is it 50? (h/l/c): l
Is it 25? (h/l/c): l
Is it 12? (h/l/c): h
Is it 18? (h/l/c): l
Is it 15? (h/l/c): l
Is it 13? (h/l/c): c
Witness my psychic powers!
Do you want to play again? (y/n): y
Think of a number between 1 and 100.
Is it 50? (h/l/c): h
Is it 75? (h/l/c): h
Is it 88? (h/l/c): h
Is it 94? (h/l/c): h
Is it 97? (h/l/c): h
Is it 99? (h/l/c): h
Is it 100? (h/l/c): c
Witness my psychic powers!
Do you want to play again? (y/n): n

** Random function **
Silica:desktop ez$ ./a.out
Think of a number between 1 and 100.
Is it 51? (h/l/c): l
Is it 7? (h/l/c): h
Is it 23? (h/l/c): l
Is it 15? (h/l/c): l
Is it 13? (h/l/c): c
Witness my psychic powers!
Do you want to play again? (y/n): y
Think of a number between 1 and 100.
Is it 33? (h/l/c): h
Is it 55? (h/l/c): l
Is it 46? (h/l/c): h
Is it 48? (h/l/c): h
Is it 51? (h/l/c): l
Is it 50? (h/l/c): c
Witness my psychic powers!
Do you want to play again? (y/n): y
Think of a number between 1 and 100.
Is it 22? (h/l/c): h
Is it 27? (h/l/c): h
Is it 88? (h/l/c): h
Is it 95? (h/l/c): h
Is it 100? (h/l/c): l
Is it 99? (h/l/c): c
Witness my psychic powers!
Do you want to play again? (y/n): n

*/
